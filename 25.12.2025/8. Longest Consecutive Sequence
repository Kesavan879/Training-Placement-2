import java.util.*;
import java.util.*;

class Solution {
    public int longestConsecutive(int[] nums) {
        if (nums == null || nums.length == 0) return 0;
        Set<Integer> set = new HashSet<>();
        for (int num : nums) set.add(num);
        int m = set.size();
        if (m == 0) return 0;
        int[] arr = new int[m];
        int i = 0;
        for (int v : set) arr[i++] = v;
        Arrays.sort(arr);
        int longest = 1;
        int current = 1;
        for (int j = 1; j < arr.length; j++) {
            if (arr[j] == arr[j - 1] + 1) {
                current++;
            } else {
                current = 1;
            }
            if (current > longest) longest = current;
        }
        return longest;
    }
}
